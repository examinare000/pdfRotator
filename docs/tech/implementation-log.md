# 実装タスク記録

最終更新日: 2025-12-22

## エントリ

- 2025-12-15: OCR向き判定APIをTDDで実装（閾値・タイムアウト・MIME/サイズバリデーション、構造化JSONエラー）、OrientationDetector抽象化を導入しテスト用スタブで検証。
- 2025-12-15: ADR-001を作成し、OCR向き判定APIの入力/出力/エラー方針とタイムアウトを決定。
- 2025-12-15: 詳細設計書を更新し、OCR APIのエラー/閾値/タイムアウト仕様を反映。
- 2025-12-15: フロントエンドに回転・ページ番号クランプ・PDFロード/描画ユーティリティをTDDで追加し、Vitest基盤を整備。
- 2025-12-15: ビューア状態管理フック（ロード/ページ遷移/回転マップ/ズーム/リセット）をTDDで実装し、jsdom環境でReactテストを実行。
- 2025-12-17: フロントの未実装UIを追加（PDFドラッグ&ドロップアップロード、ページ番号入力でジャンプ、OCR信頼度しきい値入力）。`App` の統合テストを追加し、File API差異に備えて `FileReader` フォールバック読み込みも実装。
- 2025-12-18: `/api/health` に `ocrEnabled` を追加し、フロントでOCR無効時のUI制御を追加。ルート `package.json` を追加して `npm run setup/build/test/dev` を一括実行できるようにした。
- 2025-12-19: サムネイル一覧UIに刷新し、複数選択・ショートカット回転（Ctrl/Cmd+矢印）・拡大プレビュー・Esc解除を追加。
- 2025-12-19: OCR向き判定にページ番号スイープを追加し、テキストサンプル抽出のタイムアウト設定を導入。
- 2025-12-22: サムネイル一覧に仮想スクロールを導入し、多ページのメモリ負荷を抑制。
- 2025-12-22: ヘルプ/プレビューのモーダルにフォーカストラップを追加。
- 2025-12-22: OCR向き判定を底辺1/8領域のページ番号認識精度ベースに変更。
- 2025-12-22: OCR結果の尤度返却と固定しきい値(0.6)での回転判定に変更。
